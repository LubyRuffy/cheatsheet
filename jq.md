# 基础知识

## 基础表达式
基础表达式（Basic filters)是 jq 提供的基本过滤器，用来访问 JSON 对象中的属性，主要有以下几种：

- '.' 符号。单独的一个'.'符号用来表示对作为表达式输入的整个 JSON 对象的引用。
- JSON 对象操作。jq 提供两种基本表达式用来访问 JSON 对象的属性：'.<attributename>'和'.<attributename>?'。正常情况下，这两个表达式的行为相同：都是访问对象属性，如果 JSON 对象不包含指定的属性则返回 null。区别在于，当输入不是 JSON 对象或数组时，第一个表达式会抛出异常。第二个表达式无任何输出。
- 数组操作。jq 提供三种基础表达式来操作数组：
  - 迭代器操作('.[]'). 该表达式的输入可以是数组或者 JSON 对象。输出的是基于数组元素或者 JSON 对象属性值的 iterator。
  - 访问特定元素的操作('.[index]'或'.[attributename]')。用来访问数组元素或者 JSON 对象的属性值。输出是单个值
  - 数组切片操作('.[startindex:endindex]')，其行为类似于 python 语  言中数组切片操作。
- 表达式操作(','和 '|')。表达式操作是用来关联多个基础表达式。其中逗号表示对同一个输入应用多个表达式。管道符表示将前一个表达式的输出用作后一个表达式的输入。当前一个表达式产生的结果是迭代器时，会将迭代器中的每一个值用作后一个表达式的输入从而形成新的表达式。例如'.[]|.+1', 在这个表达式中，第一个子表达式'.[]'在输入数组上构建迭代器，第二个子表达式则在迭代器的每个元素上加 1。

## 基础操作
* 格式化展示
```bash
$ echo -ne '{"a":1, "b":2}' | jq
# 相当于
$ echo -ne '{"a":1, "b":2}' | jq '.'
```
```json
{
 "a": 1,
 "b": 2
}
```

* 返回某一个字段的值
```bash
$ echo -ne '{"a":1, "b":2}' | jq '.a'
1
```

# 任务场景
* 如何列出所有的属性名称（key）?
```bash
$ echo -ne '{"a":1, "b":2, "c":{"c1":[11,22,33], "c2":[123,456,789]}}' | jq 'keys'
[
  "a",
  "b",
  "c"
]
```
这里看到只针对顶级的进行处理。

* 如何组合显示多个key对应的value？
```json
{
  "a": 1,
  "b": 2,
  "c": {
    "c1": [
      11, 22, 33
    ],
    "c2": [
      123, 456, 789
    ]
  }
}
```
```bash
$ jq '.c | "\(.c1[0]):\(.c2[0])"'
"11:123"
```

# 常见问题